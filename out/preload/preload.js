"use strict";const{contextBridge:t,ipcRenderer:i}=require("electron");t.exposeInMainWorld("electronAPI",{initQshell:(e,o,r)=>i.invoke("init-qshell",{ak:e,sk:o,bucket:r}),checkQshell:e=>i.invoke("check-account",e),startUpload:e=>i.invoke("start-upload",e),onUploadProgress:e=>i.on("upload-progress",(o,r)=>e(r)),uploadToQiniu:e=>i.invoke("uploadToQiniu",e),uploadFileStream:e=>i.invoke("uploadFileStream",e),uploadProjectJSON:e=>i.invoke("uploadProjectJSON",e),listQiniuFiles:e=>i.invoke("listQiniuFiles",e),checkQiniuFolder:e=>i.invoke("checkQiniuFolder",e),createQiniuFolder:e=>i.invoke("createQiniuFolder",e),checkQiniuFile:e=>i.invoke("checkQiniuFileExists",e),downLoadQiniuFile:e=>i.invoke("downloadQiniuFile",e),readJSONFile:e=>i.invoke("readJSONFile",e),listFiles:e=>i.invoke("listFiles",e),moveFile:(e,o)=>i.invoke("moveFile",e,o),deleteFile:e=>i.invoke("deleteFile",e),selectDirectory:()=>i.invoke("select-directory"),readDirectory:e=>i.invoke("read-directory",e),readAllImagesRecursively:e=>i.invoke("read-images-recursively",e),saveFile:(e,o,r)=>i.invoke("save-excel",{content:e,filename:o,defaultPath:r}),saveJSON:e=>i.invoke("save-json",e),saveFileSilently:(e,o)=>i.invoke("save-file-silently",{content:e,filePath:o}),saveImage:(e,o,r)=>i.invoke("save-image",{content:Buffer.from(e),filename:o,defaultPath:r}),saveImageSilently:e=>i.invoke("save-image-silently",e),writeClipboardText:e=>i.invoke("write-clipboard-text",e),simulatePaste:()=>i.invoke("simulate-paste"),checkDirectoryExists:e=>i.invoke("check-directory-exists",e),createDirectory:e=>i.invoke("create-directory",e),listDirectories:async e=>{const o=await i.invoke("listDirectories",e);if(o.success)return o.directories;throw new Error(o.error)},getDirectoryFileCount:e=>i.invoke("get-directory-file-count",e),openDirectoryDialog:()=>i.invoke("open-directory-dialog"),selectFile:e=>i.invoke("select-file",e),readFile:e=>i.invoke("read-file",e),readExcel:e=>i.invoke("read-excel",e),saveProjectList:e=>i.invoke("save-project-list",e),loadProjectList:()=>i.invoke("load-project-list"),existsFolder:e=>i.invoke("check-folder-exists",e),readDirectoryNames:e=>i.invoke("read-directory-names",e),checkFileExists:e=>i.invoke("check-file-exists",e),getMacAddress:()=>i.invoke("get-mac-address"),exitApp:()=>i.invoke("exit-app")});t.exposeInMainWorld("env",{isDev:process.env.NODE_ENV==="development"});t.exposeInMainWorld("updateAPI",{checkForUpdates:()=>i.invoke("check-for-updates"),quitAndInstall:()=>i.send("quit-and-install"),onUpdateMessage:e=>i.on("update-message",(o,r)=>e(r)),onUpdateAvailable:e=>i.on("update-available",(o,r)=>e(r)),onUpdateNotAvailable:e=>i.on("update-not-available",()=>e()),onDownloadProgress:e=>i.on("download-progress",(o,r)=>e(r)),onUpdateDownloaded:e=>i.on("update-downloaded",()=>e()),onUpdateError:e=>i.on("update-error",(o,r)=>e(r))});
